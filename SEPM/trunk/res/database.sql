DROP TABLE RaceResult IF EXISTS;
DROP TABLE Horse IF EXISTS;
DROP TABLE Jockey IF EXISTS;


CREATE TABLE Horse(id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, name VARCHAR(30) NOT NULL, age INTEGER NOT NULL CHECK age>0, min_speed DOUBLE NOT NULL, max_speed DOUBLE NOT NULL, picture VARCHAR(30) NOT NULL, is_deleted BOOLEAN NOT NULL DEFAULT false, CHECK min_speed<=max_speed AND min_speed>0.0 and max_speed>0.0);
CREATE TABLE Jockey(id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, first_name VARCHAR(30) NOT NULL,last_name VARCHAR(30) NOT NULL, country VARCHAR(30) NOT NULL, skill DOUBLE NOT NULL, is_deleted BOOLEAN NOT NULL DEFAULT false);
CREATE TABLE RaceResult(race_id INTEGER NOT NULL, horse_id INTEGER REFERENCES Horse(id), jockey_id INTEGER REFERENCES Jockey(id), horse_name VARCHAR(30) NOT NULL, jockey_name VARCHAR(61) NOT NULL, random_speed DOUBLE NOT NULL CHECK random_speed>0.0, luck_factor DOUBLE NOT NULL, jockey_skill_calc DOUBLE NOT NULL, average_speed DOUBLE NOT NULL, rank INTEGER NOT NULL CHECK rank>0, PRIMARY KEY(race_id, horse_id, jockey_id));


INSERT INTO Horse(name,age,min_speed,max_speed,picture) VALUES ('Jacky',15,55.6,88.9,'');
INSERT INTO Horse(name,age,min_speed,max_speed,picture) VALUES ('Avenida',23,56.0,82.9,'');
INSERT INTO Horse(name,age,min_speed,max_speed,picture) VALUES ('Manchego',30,51.6,79.1,'');
INSERT INTO Horse(name,age,min_speed,max_speed,picture) VALUES ('Trixie',19,59.6,90.7,'');
INSERT INTO Horse(name,age,min_speed,max_speed,picture) VALUES ('Dark Sparks',22,65.6,95.2,'');
INSERT INTO Horse(name,age,min_speed,max_speed,picture,is_deleted) VALUES ('Penny',12,52.6,85.3,'',true);
INSERT INTO Horse(name,age,min_speed,max_speed,picture) VALUES ('Sweet Ranger',28,51.9,85.2,'');
INSERT INTO Horse(name,age,min_speed,max_speed,picture,is_deleted) VALUES ('Finnigan',16,51.0,90.2,'',true);
INSERT INTO Horse(name,age,min_speed,max_speed,picture) VALUES ('Sherman',24,50.8,96.2,'');
INSERT INTO Horse(name,age,min_speed,max_speed,picture) VALUES ('Swiftbolt',16,65.6,95.1,'');

INSERT INTO Jockey(first_name,last_name,country,skill) VALUES ('Eddie','Ahern','Ireland',3.0);
INSERT INTO Jockey(first_name,last_name,country,skill) VALUES ('Robby','Albarado','United States',1.0);
INSERT INTO Jockey(first_name,last_name,country,skill) VALUES ('Steve','Cauthen','United States',-2.0);
INSERT INTO Jockey(first_name,last_name,country,is_deleted,skill) VALUES ('Patricia','Cooksey','United States',true,4.0);
INSERT INTO Jockey(first_name,last_name,country,skill) VALUES ('Alan','Garcia','Peru',5.0);
INSERT INTO Jockey(first_name,last_name,country,skill) VALUES ('Julien','Leparoux','France',-7.0);
INSERT INTO Jockey(first_name,last_name,country,skill) VALUES ('Kirsty','Milczarek','Poland',8.0);
INSERT INTO Jockey(first_name,last_name,country,is_deleted,skill) VALUES ('Anna','Napravnik','United States',true,9.0);
INSERT INTO Jockey(first_name,last_name,country,skill) VALUES ('Lance','Sullivan','New Zealand',2.0);
INSERT INTO Jockey(first_name,last_name,country,skill) VALUES ('Stephane','Pasquier','France',0.0);

INSERT INTO RaceResult(race_id,horse_id,jockey_id,horse_name,jockey_name,random_speed,luck_factor,jockey_skill_calc,average_speed,rank) VALUES (1,1,3,'Jacky','Stevie Cauthen',70.5,0.99,-0.04,-2.79,5);
INSERT INTO RaceResult(race_id,horse_id,jockey_id,horse_name,jockey_name,random_speed,luck_factor,jockey_skill_calc,average_speed,rank) VALUES (1,3,5,'Manchego','Alan Garcia',60.1,0.96,3.15,181.74,2);
INSERT INTO RaceResult(race_id,horse_id,jockey_id,horse_name,jockey_name,random_speed,luck_factor,jockey_skill_calc,average_speed,rank) VALUES (1,5,7,'Dark Sparks','Kirsty Milczarek',90.6,1.03,3.77,351.81,1);
INSERT INTO RaceResult(race_id,horse_id,jockey_id,horse_name,jockey_name,random_speed,luck_factor,jockey_skill_calc,average_speed,rank) VALUES (1,7,9,'Sweet Ranger','Lance Sullivan',52.9,0.98,2.04,105.8,4);
INSERT INTO RaceResult(race_id,horse_id,jockey_id,horse_name,jockey_name,random_speed,luck_factor,jockey_skill_calc,average_speed,rank) VALUES (1,9,1,'Sherman','Eddie Ahern',52.9,0.98,2.48,128.6,3);
INSERT INTO RaceResult(race_id,horse_id,jockey_id,horse_name,jockey_name,random_speed,luck_factor,jockey_skill_calc,average_speed,rank) VALUES (2,2,4,'Avenida','Patricia Cooksey',80.0,0.99,2.85,225.72,2);
INSERT INTO RaceResult(race_id,horse_id,jockey_id,horse_name,jockey_name,random_speed,luck_factor,jockey_skill_calc,average_speed,rank) VALUES (2,4,6,'Trixie','Julien Leparoux',60.0,0.97,-1.6,-93.12,5);
INSERT INTO RaceResult(race_id,horse_id,jockey_id,horse_name,jockey_name,random_speed,luck_factor,jockey_skill_calc,average_speed,rank) VALUES (2,6,8,'Penny','Anna Napravnik',77.7,1.0,3.91,303.81,1);
INSERT INTO RaceResult(race_id,horse_id,jockey_id,horse_name,jockey_name,random_speed,luck_factor,jockey_skill_calc,average_speed,rank) VALUES (2,10,2,'Swiftbolt','Robby Albarado',66.6,1.04,1.54,106.67,4);
INSERT INTO RaceResult(race_id,horse_id,jockey_id,horse_name,jockey_name,random_speed,luck_factor,jockey_skill_calc,average_speed,rank) VALUES (2,1,1,'Jacky','Eddie Ahern',88.8,0.99,2.48,218.02,3);